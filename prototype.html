<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="UTF-8">
    <script src="./dist/router.js"></script>
  </head>
  <body>
    <h1 id="context">{ROOT}</h1>
    <!-- TODO: complete functional protoype -->
    <script>
      window.onload = (e) => {
        const context = document.querySelector('#context');
        const routes = [
          {
            path: '/',
            name: 'home'
          },
          {
            path: '/user/:userId/profile',
            name: 'user-profile'
          },
          {
            path: '*',
            name: 'not-found'
          }
        ];

        const matchRoute = (e) => {
          console.log(`Trying Route: ${e.location.path}`);
          // const route = routes.find(r => e.$tools.match(e.location.path, r.path));
          const route = routes.find(r => {
            console.log(r);
            return e.$tools.match(e.location.path, r.path)
          });
          console.log(route);
          if (route) {
            context.innerText = route.name;
          }
        };

        const router = new Router({
          client: {
            onStart(e) {
              console.log('Started');
              matchRoute(e);
            },
            onNavigate(e) {
              console.log('Navigated!');
              matchRoute(e);
            },
            onStop() {
              console.log('Stopped!');
            }
          }
        });

        router.start();
      }
    </script>
  </body>
</html>
